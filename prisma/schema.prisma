generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("SUPABASE_CONNECTION_STRING")
}

model DimTags {
  tagId   Int    @map("tag_id")
  postId Int @map("post_id")
  tagName String @map("tag_name")
  @@id([tagId, postId])
  @@map("dim_tags")
}

model DimComments {
  commentId Int @id @unique @default(autoincrement()) @map("comment_id")
  postId    Int @map("post_id")
  commentAuthor String @map("comment_author")
  commentAuthorIpHash String @map("comment_author_ip_hash")
  commentDateJst DateTime @map("comment_date_jst")
  commentDateGmt DateTime @map("comment_date_gmt")
  commentContent String @map("comment_content")
  commentParent Int @map("comment_parent")

  @@map("dim_comments")
}

model FctPostVoteHisotry {
  voteDateGmt DateTime @map("vote_date_gmt")
  voteUserIpHash String @map("vote_user_ip_hash")
  postId Int @map("post_id")
  voteTypeInt Int @map("vote_type_int")
  
  @@id([voteDateGmt, voteUserIpHash, postId])
  @@map("fct_post_vote_history")
}

model FctCommentVoteHisotry {
  commentVoteId Int @id @unique @map("comment_vote_id") @default(autoincrement())
  commentId Int @map("comment_id")
  voteType Int @map("vote_type")
  postId Int @map("post_id")
  commentVoteDateJst DateTime @map("comment_vote_date_jst")
  voteUserIpHash String @map("vote_user_ip_hash")

  @@map("fct_comment_vote_history")
}

model userProfiles {
  userId String @id @unique @map("user_id")
  userName String @unique @map("user_name")
  userCreatedAt DateTime @map("user_created_at") @default(now())
  userEmail String @map("user_email")

  @@map("user_profiles")
}

model nowEditingPages {
  postId Int @id @map("post_id") @unique
  userName String @map("user_name") @unique
  lastHeartBeatAtUTC DateTime @map("last_heart_beat_at_utc") @default(now())
  @@map("now_editing_pages")
}

model DimPosts {
  postId Int @id @unique @map("post_id") @default(autoincrement())
  postAuthorIPHash Decimal @map("post_author_hash")
  postDateJst DateTime @map("post_date_jst")
  postDateGmt DateTime @map("post_date_gmt")
  postContent String @map("post_content")
  postTitle String @map("post_title")
  commentStatus String @map("comment_status")
  postUrl String @map("post_url")
  countLikes Int @map("count_likes")
  countDislikes Int @map("count_dislikes")
  uuid String @map("uuid") @default(uuid())

  @@map("dim_posts")
}

model FctPostEditHistory {
  postId Int @map("post_id")
  postRevisionNumber Int @map("post_revision_number")
  postEditDateJst DateTime @map("post_edit_date_jst")
  postEditDateGmt DateTime @map("post_edit_date_gmt")
  editorUserName String @map("editor_user_name")
  postTitleBeforeEdit String @map("post_title_before_edit")
  postTitleAfterEdit String @map("post_title_after_edit")
  postContentBeforeEdit String @map("post_content_before_edit")
  postContentAfterEdit String @map("post_content_after_edit")

  @@id([postId, postRevisionNumber])
  @@map("fct_post_edit_history")
}
